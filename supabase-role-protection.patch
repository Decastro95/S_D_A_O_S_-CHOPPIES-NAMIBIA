diff --git a/lib/supabase.js b/lib/supabase.js
new file mode 100644
index 0000000..1111111
--- /dev/null
+++ b/lib/supabase.js
@@
+import { createClient } from "@supabase/supabase-js";
+
+export const supabase = createClient(
+  process.env.NEXT_PUBLIC_SUPABASE_URL,
+  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY
+);
diff --git a/lib/withAuth.js b/lib/withAuth.js
new file mode 100644
index 0000000..1111111
--- /dev/null
+++ b/lib/withAuth.js
@@
+import { useEffect, useState } from "react";
+import { useRouter } from "next/router";
+import { supabase } from "./supabase";
+
+export default function withAuth(Component, allowedRoles = []) {
+  return function ProtectedPage(props) {
+    const [loading, setLoading] = useState(true);
+    const [authorized, setAuthorized] = useState(false);
+    const router = useRouter();
+
+    useEffect(() => {
+      const checkUser = async () => {
+        const { data: { user } } = await supabase.auth.getUser();
+        if (!user) {
+          router.replace("/login");
+          return;
+        }
+
+        // fetch profile role
+        const { data: profile } = await supabase
+          .from("profiles")
+          .select("role")
+          .eq("id", user.id)
+          .single();
+
+        if (!profile) {
+          router.replace("/login");
+          return;
+        }
+
+        if (allowedRoles.includes(profile.role)) {
+          setAuthorized(true);
+        } else {
+          router.replace("/login");
+        }
+        setLoading(false);
+      };
+
+      checkUser();
+    }, []);
+
+    if (loading) return <p className="p-6">Loading...</p>;
+    if (!authorized) return null;
+
+    return <Component {...props} />;
+  };
+}
diff --git a/pages/admin.js b/pages/admin.js
index 3333333..6666666 100644
--- a/pages/admin.js
+++ b/pages/admin.js
@@
 import Layout from "../components/Layout";
 import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from "recharts";
+import withAuth from "../lib/withAuth";
 
 const data = [
   { month: "Jan", revenue: 500 },
@@
- export default function Admin() {
+function Admin() {
   return (
     <Layout>
       <h2 className="text-2xl font-bold mb-6">Admin Dashboard</h2>
@@
   )
 }
+
+export default withAuth(Admin, ["admin"]);
diff --git a/pages/manager.js b/pages/manager.js
index 4444444..7777777 100644
--- a/pages/manager.js
+++ b/pages/manager.js
@@
 import Layout from "../components/Layout";
 import { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from "recharts";
+import withAuth from "../lib/withAuth";
 
 const data = [
   { region: "North", sales: 400 },
@@
- export default function Manager() {
+function Manager() {
   return (
     <Layout>
       <h2 className="text-2xl font-bold mb-6">Manager Dashboard</h2>
@@
   )
 }
+
+export default withAuth(Manager, ["manager", "admin"]);
diff --git a/pages/cashier.js b/pages/cashier.js
index 5555555..8888888 100644
--- a/pages/cashier.js
+++ b/pages/cashier.js
@@
 import Layout from "../components/Layout";
 import { AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from "recharts";
+import withAuth from "../lib/withAuth";
 
 const data = [
   { hour: "08:00", sales: 200 },
@@
- export default function Cashier() {
+function Cashier() {
   return (
     <Layout>
       <h2 className="text-2xl font-bold mb-6">Cashier Dashboard</h2>
@@
   )
 }
+
+export default withAuth(Cashier, ["cashier", "manager", "admin"]);
